# ========================================================================
# Cloud Secrets Manifest for OKE Production
# ========================================================================
# This manifest defines secrets for Redpanda Cloud, PostgreSQL, and Redis.
# These should be managed via OCI Secrets or external secrets operator.
#
# Apply with: kubectl apply -f k8s/base/cloud-secrets.yaml
# ========================================================================

apiVersion: v1
kind: Secret
metadata:
  name: taskflow-cloud-secrets
  namespace: todo-app
type: Opaque
stringData:
  # Redpanda Cloud Kafka credentials
  # Get these from your Redpanda Cloud console
  KAFKA_BOOTSTRAP_SERVERS: "your-redpanda-cluster.xx.kafka.elasticache.amazonaws.com:9092"
  KAFKA_USERNAME: "your-redpanda-username"
  KAFKA_PASSWORD: "your-redpanda-password"

  # PostgreSQL connection (OCI PostgreSQL or Autonomous)
  # Format: postgresql://user:password@host:5432/database
  DATABASE_URL: "postgresql://taskflow:password@your-pg-host.postgres.database.oraclecloud.com:5432/taskflow"

  # Redis (OCI Redis or external provider)
  REDIS_HOST: "your-redis-host.redis.cache.elasticache.amazonaws.com"
  REDIS_PORT: "6379"
  REDIS_PASSWORD: "your-redis-password"

  # AI API Keys
  GEMINI_API_KEY: "your-gemini-api-key"

  # Application secrets
  SECRET_KEY: "your-application-secret-key-min-32-chars"
  JWT_SECRET: "your-jwt-secret-key"

---
# ========================================================================
# External Secrets Operator configuration (optional)
# Uncomment if using ESO with OCI Vault
# ========================================================================
# apiVersion: external-secrets.io/v1beta1
# kind: ClusterSecretStore
# metadata:
#   name: oci-vault-store
# spec:
#   provider:
#     oci:
#       vault: "https://vault.us-phoenix-1.oci.oraclecloud.com/20230101/kvv1"
# ---
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: taskflow-redpanda-secrets
#   namespace: todo-app
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     name: oci-vault-store
#     kind: ClusterSecretStore
#   target:
#     name: taskflow-cloud-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: KAFKA_BOOTSTRAP_SERVERS
#       remoteRef:
#         key: taskflow/production/kafka
#         property: bootstrap_servers
#     - secretKey: KAFKA_USERNAME
#       remoteRef:
#         key: taskflow/production/kafka
#         property: username
#     - secretKey: KAFKA_PASSWORD
#       remoteRef:
#         key: taskflow/production/kafka
#         property: password
